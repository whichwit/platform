# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Basic workflow
'on':
  push:
    branches:
      - main
jobs:
  bazel_test:
    runs-on: ubuntu-latest
    services:
      # Label used to access the service container
      mssql:
        # Docker Hub image
        image: mcr.microsoft.com/mssql/server:2019-latest
        env:
          ACCEPT_EULA: Y
          SA_PASSWORD: Password1!
        ports:
          - 1433:1433
    steps:
      - run: docker ps -a
      - run: sqlcmd -S localhost -U sa -P Password1! -Q "SET PARSEONLY ON; SELECT GETDATE()"
      # - run: sqlcmd -S localhost -U sa -P Password1! -q "SELECT GETDATE()" -o output.txt
      - run: cat output.txt
      - name: Set up Bazel
        run: npm i @bazel/bazelisk
      - name: Check out repository code
        uses: actions/checkout@v2
      # - run: npm i @bazel/bazelisk
      - name: Execute unit test
        run: bazelisk test //...